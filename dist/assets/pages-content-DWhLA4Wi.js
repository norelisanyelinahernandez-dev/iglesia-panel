import{u as H,j as e,D as X,g as ae,a as q,c as te,r as se,d as ie,b as ne,s as re,e as Z,f as oe,h as le,i as Y,k as ce,l as de,m as me,n as ge}from"./pages-admin-CWKDlqNg.js";import{r as c}from"./vendor-react-D_uAx6on.js";const he={culto:"badge-gold",retiro:"badge-blue",conferencia:"badge-blue",boda:"badge-green",bautismo:"badge-gold",celula:"badge-amber",otro:"badge-green"},U={culto:"â›ª",retiro:"ðŸ•ï¸",conferencia:"ðŸŽ¤",boda:"ðŸ’",bautismo:"ðŸ’§",celula:"ðŸ‘¥",otro:"ðŸ“…"},P={culto:"Culto",retiro:"Retiro",conferencia:"Conferencia",boda:"Boda",bautismo:"Bautismo",celula:"CÃ©lula",otro:"Otro"};function ue({title:i,onClose:u,children:x}){return e.jsx("div",{className:"modal-overlay",onClick:h=>h.target===h.currentTarget&&u(),children:e.jsxs("div",{className:"modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"modal-title",children:i}),e.jsx("button",{className:"modal-close",onClick:u,children:"Ã—"})]}),x]})})}function _e(){var d;const{puedeEditar:i}=H(),u=i("eventos"),[x,h]=c.useState([]),[n,m]=c.useState(!0),[r,f]=c.useState(null),[v,b]=c.useState(null),[s,N]=c.useState(null),[p,j]=c.useState({nombre:"",tipo:"culto",descripcion:"",fecha_inicio:"",fecha_fin:"",lugar:""}),[y,w]=c.useState({nombre_visita:"",telefono_visita:""}),[E,k]=c.useState(!1),[S,z]=c.useState(""),o=async()=>{m(!0);try{const{data:a}=await ae();h(a)}catch{}m(!1)};c.useEffect(()=>{o()},[]);const A=async a=>{b(a),N(null);try{const{data:l}=await q(a.id);N(l)}catch{}},B=async a=>{var l,C;a.preventDefault(),k(!0),z("");try{if(!p.fecha_inicio){z("La fecha es requerida"),k(!1);return}const _=new Date(p.fecha_inicio);if(isNaN(_.getTime())){z("Fecha invÃ¡lida"),k(!1);return}const D={nombre:p.nombre,tipo:p.tipo||null,descripcion:p.descripcion||null,lugar:p.lugar||null,fecha_inicio:_.toISOString(),fecha_fin:p.fecha_fin?new Date(p.fecha_fin).toISOString():null};await te(D),o(),f(null),j({nombre:"",tipo:"culto",descripcion:"",fecha_inicio:"",fecha_fin:"",lugar:""})}catch(_){const D=(C=(l=_.response)==null?void 0:l.data)==null?void 0:C.detail;Array.isArray(D)?z(D.map(W=>W.msg||JSON.stringify(W)).join(", ")):z(typeof D=="string"?D:"Error al crear evento")}k(!1)},t=async a=>{a.preventDefault(),k(!0);try{await se(v.id,{nombre_visita:y.nombre_visita,telefono_visita:y.telefono_visita,presente:!0});const{data:l}=await q(v.id);N(l),w({nombre_visita:"",telefono_visita:""})}catch{}k(!1)},g=async a=>{if(confirm("Â¿Eliminar este evento?"))try{await ie(a),o()}catch{}};return e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Eventos"}),e.jsxs("p",{className:"page-subtitle",children:[x.length," eventos registrados"]})]}),u&&e.jsx("button",{className:"btn btn-gold",onClick:()=>{z(""),f("nuevo")},children:"+ Nuevo evento"})]}),e.jsx("div",{style:{display:"flex",gap:10,marginBottom:24,flexWrap:"wrap"},children:["culto","retiro","boda","bautismo","conferencia","celula"].map(a=>{const l=x.filter(C=>C.tipo===a).length;return l===0?null:e.jsxs("div",{style:{background:"var(--surface)",border:"1px solid var(--border)",borderRadius:10,padding:"10px 16px",display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:18},children:U[a]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:16},children:l}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:[P[a],"s"]})]})]},a)})}),n?e.jsx("div",{style:{textAlign:"center",padding:60},children:e.jsx("span",{className:"spinner",style:{width:28,height:28}})}):e.jsx("div",{className:"grid-3",children:x.map(a=>e.jsxs("div",{className:"card",style:{position:"relative",cursor:"default"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:12},children:[e.jsx("span",{style:{fontSize:26},children:U[a.tipo]||"ðŸ“…"}),e.jsx("span",{className:`badge ${he[a.tipo]||"badge-green"}`,children:P[a.tipo]||a.tipo})]}),e.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontSize:16,fontWeight:600,marginBottom:6},children:a.nombre}),e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:12,marginBottom:4},children:["\\ud83d\\udcc5 ",new Date(a.fecha_inicio).toLocaleDateString("es-DO",{weekday:"short",year:"numeric",month:"short",day:"numeric"})]}),a.lugar&&e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:12,marginBottom:12},children:["\\ud83d\\udccd ",a.lugar]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:14,borderTop:"1px solid var(--border)",paddingTop:12},children:[e.jsx("button",{className:"btn btn-ghost",style:{flex:1,justifyContent:"center",fontSize:12,padding:"6px"},onClick:()=>A(a),children:"Ver asistencia"}),u&&e.jsx("button",{className:"btn btn-danger",style:{padding:"6px 10px",fontSize:12},onClick:()=>g(a.id),children:"âœ•"})]})]},a.id))}),r==="nuevo"&&e.jsxs(ue,{title:"Nuevo evento",onClose:()=>f(null),children:[S&&e.jsx("div",{className:"alert alert-error",children:S}),e.jsxs("form",{onSubmit:B,style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Nombre del evento *"}),e.jsx("input",{value:p.nombre,onChange:a=>j({...p,nombre:a.target.value}),className:"form-input",required:!0})]}),e.jsxs("div",{className:"grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tipo"}),e.jsx("select",{value:p.tipo,onChange:a=>j({...p,tipo:a.target.value}),className:"form-input",children:["culto","retiro","conferencia","boda","bautismo","celula","otro"].map(a=>e.jsx("option",{value:a,children:P[a]},a))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Fecha y hora *"}),e.jsx(X,{name:"fecha_inicio",value:p.fecha_inicio,onChange:a=>j({...p,fecha_inicio:a.target.value}),required:!0})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Lugar"}),e.jsx("input",{value:p.lugar,onChange:a=>j({...p,lugar:a.target.value}),className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"DescripciÃ³n"}),e.jsx("textarea",{value:p.descripcion,onChange:a=>j({...p,descripcion:a.target.value}),className:"form-input",rows:2,style:{resize:"vertical"}})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>f(null),children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-gold",disabled:E,children:E?"Guardando...":"Crear evento"})]})]})]}),v&&e.jsx("div",{className:"modal-overlay",onClick:a=>a.target===a.currentTarget&&b(null),children:e.jsxs("div",{className:"modal",style:{maxWidth:550},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{className:"modal-title",children:["Asistencia â€“ ",v.nombre]}),e.jsx("button",{className:"modal-close",onClick:()=>b(null),children:"Ã—"})]}),s&&e.jsxs("div",{style:{display:"flex",gap:16,marginBottom:20},children:[e.jsxs("div",{style:{background:"var(--green-dim)",borderRadius:8,padding:"10px 20px",flex:1,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--green)"},children:s.presentes}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Presentes"})]}),e.jsxs("div",{style:{background:"var(--blue-dim)",borderRadius:8,padding:"10px 20px",flex:1,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:22,fontWeight:700,color:"var(--blue)"},children:s.total_registros}),e.jsx("div",{style:{fontSize:11,color:"var(--text-muted)"},children:"Total"})]})]}),e.jsxs("form",{onSubmit:t,style:{display:"flex",gap:10,marginBottom:18},children:[e.jsx("input",{placeholder:"Nombre de visita",value:y.nombre_visita,onChange:a=>w({...y,nombre_visita:a.target.value}),className:"form-input",style:{flex:2},required:!0}),e.jsx("input",{placeholder:"Tel\\u00e9fono",value:y.telefono_visita,onChange:a=>w({...y,telefono_visita:a.target.value}),className:"form-input",style:{flex:1}}),e.jsx("button",{type:"submit",className:"btn btn-gold",disabled:E,style:{whiteSpace:"nowrap"},children:"+ Agregar"})]}),s?((d=s.registros)==null?void 0:d.length)===0?e.jsx("div",{style:{textAlign:"center",padding:20,color:"var(--text-muted)",fontSize:13},children:"Sin registros aÃºn"}):e.jsx("div",{style:{maxHeight:250,overflowY:"auto"},children:s.registros.map((a,l)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0",borderBottom:"1px solid var(--border)"},children:[e.jsx("span",{style:{fontWeight:500,fontSize:13},children:a.nombre_visita||"Miembro registrado"}),e.jsx("span",{className:`badge ${a.presente?"badge-green":"badge-red"}`,children:a.presente?"Presente":"Ausente"})]},l))}):e.jsx("div",{style:{textAlign:"center",padding:20},children:e.jsx("span",{className:"spinner"})})]})})]})}const T={nombre:"",cargo:"",telefono:"",email:"",direccion:"",biografia:"",versiculo:"",anios_ministerio:"",especialidad:"",foto_url:""};function ze(){const[i,u]=c.useState(T),[x,h]=c.useState(!1),[n,m]=c.useState(T),[r,f]=c.useState(!1),[v,b]=c.useState(!0);c.useEffect(()=>{ne().then(j=>{const y=j.data||T;u(y),m(y)}).catch(()=>{}).finally(()=>b(!1))},[]);const s=j=>m({...n,[j.target.name]:j.target.value}),N=async j=>{j.preventDefault();try{await re(n),u(n),h(!1),f(!0),setTimeout(()=>f(!1),3e3)}catch{}},p=(j,y)=>y?e.jsxs("div",{style:{marginBottom:10},children:[e.jsx("div",{style:{color:"var(--text-muted)",fontSize:12,marginBottom:2},children:j}),e.jsx("div",{style:{fontWeight:500},children:y})]}):null;return v?e.jsx("div",{style:{textAlign:"center",padding:60},children:e.jsx("span",{className:"spinner"})}):e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Perfil de la Pastora"}),e.jsx("p",{className:"page-subtitle",children:"InformaciÃ³n pastoral y ministerial"})]}),!x&&e.jsx("button",{className:"btn btn-gold",onClick:()=>{m(i),h(!0)},children:"âœï¸ Editar perfil"})]}),r&&e.jsx("div",{className:"alert alert-success",style:{marginBottom:16},children:"âœ… Perfil guardado correctamente"}),x?e.jsx("div",{className:"card",style:{maxWidth:660},children:e.jsxs("form",{onSubmit:N,style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsx("div",{style:{borderLeft:"3px solid var(--gold)",paddingLeft:10,marginBottom:4},children:e.jsx("span",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:13,color:"var(--gold)",textTransform:"uppercase",letterSpacing:1},children:"InformaciÃ³n Personal"})}),e.jsxs("div",{className:"grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Nombre completo *"}),e.jsx("input",{name:"nombre",value:n.nombre,onChange:s,className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Cargo / TÃ­tulo"}),e.jsx("input",{name:"cargo",value:n.cargo,onChange:s,className:"form-input",placeholder:"Ej: Pastora Principal"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"TelÃ©fono"}),e.jsx("input",{name:"telefono",value:n.telefono,onChange:s,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Correo"}),e.jsx("input",{name:"email",type:"email",value:n.email,onChange:s,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"AÃ±os en el ministerio"}),e.jsx("input",{name:"anios_ministerio",value:n.anios_ministerio,onChange:s,className:"form-input",placeholder:"Ej: 15"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"URL de foto (opcional)"}),e.jsx("input",{name:"foto_url",value:n.foto_url,onChange:s,className:"form-input",placeholder:"https://..."})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"DirecciÃ³n"}),e.jsx("input",{name:"direccion",value:n.direccion,onChange:s,className:"form-input"})]}),e.jsx("div",{style:{borderLeft:"3px solid var(--gold)",paddingLeft:10,margin:"8px 0 4px"},children:e.jsx("span",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:13,color:"var(--gold)",textTransform:"uppercase",letterSpacing:1},children:"Ministerio"})}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Especialidad ministerial"}),e.jsx("input",{name:"especialidad",value:n.especialidad,onChange:s,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"BiografÃ­a"}),e.jsx("textarea",{name:"biografia",value:n.biografia,onChange:s,className:"form-input",rows:4,style:{resize:"vertical"}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"VersÃ­culo favorito"}),e.jsx("input",{name:"versiculo",value:n.versiculo,onChange:s,className:"form-input",placeholder:"Ej: Juan 7:38"})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:6},children:[e.jsx("button",{type:"button",className:"btn btn-ghost",onClick:()=>h(!1),children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn btn-gold",children:"ðŸ’¾ Guardar perfil"})]})]})}):e.jsxs("div",{style:{display:"flex",gap:24,flexWrap:"wrap"},children:[e.jsxs("div",{className:"card",style:{flex:"0 0 260px",textAlign:"center",padding:32},children:[i.foto_url?e.jsx("img",{src:i.foto_url,alt:"Foto pastora",style:{width:140,height:140,borderRadius:"50%",objectFit:"cover",border:"3px solid var(--gold)",marginBottom:16}}):e.jsx("div",{style:{width:140,height:140,borderRadius:"50%",background:"var(--bg-card)",border:"3px solid var(--gold)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:48,margin:"0 auto 16px"},children:"ðŸ‘©â€ðŸ’¼"}),e.jsx("h2",{style:{fontFamily:"var(--font-heading)",fontSize:20,fontWeight:700,marginBottom:4},children:i.nombre||"Sin nombre"}),e.jsx("div",{style:{color:"var(--gold)",fontWeight:600,marginBottom:8},children:i.cargo||"Pastora"}),i.anios_ministerio&&e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:13},children:[i.anios_ministerio," aÃ±os en el ministerio"]})]}),e.jsxs("div",{style:{flex:1,minWidth:280,display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{borderLeft:"3px solid var(--gold)",paddingLeft:10,marginBottom:14},children:e.jsx("span",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:13,color:"var(--gold)",textTransform:"uppercase",letterSpacing:1},children:"InformaciÃ³n de contacto"})}),p("TelÃ©fono",i.telefono),p("Correo",i.email),p("DirecciÃ³n",i.direccion),!i.telefono&&!i.email&&!i.direccion&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13},children:"Sin informaciÃ³n de contacto"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{style:{borderLeft:"3px solid var(--gold)",paddingLeft:10,marginBottom:14},children:e.jsx("span",{style:{fontFamily:"var(--font-heading)",fontWeight:700,fontSize:13,color:"var(--gold)",textTransform:"uppercase",letterSpacing:1},children:"Ministerio"})}),p("Especialidad",i.especialidad),p("BiografÃ­a",i.biografia),!i.especialidad&&!i.biografia&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13},children:"Sin informaciÃ³n ministerial"})]}),i.versiculo&&e.jsxs("div",{className:"card",style:{borderLeft:"3px solid var(--gold)"},children:[e.jsxs("p",{style:{fontStyle:"italic",fontSize:15,color:"var(--text)",marginBottom:6},children:['"',i.versiculo,'"']}),e.jsx("span",{style:{color:"var(--gold)",fontSize:12,fontWeight:600},children:"â€” VersÃ­culo favorito"})]})]})]})]})}const O=["Lunes","Martes","MiÃ©rcoles","Jueves","Viernes","SÃ¡bado","Domingo"],pe=["Culto de avivamiento","Estudio bÃ­blico","Escuela de niÃ±os","Visita a enfermos","Celula","Retiro congregacional","Culto unido"],ee={"Culto de avivamiento":"ðŸ”¥","Estudio bÃ­blico":"ðŸ“–","Escuela de niÃ±os":"ðŸ‘§","Visita a enfermos":"ðŸ¥",Celula:"ðŸ ","Retiro congregacional":"â›º","Culto unido":"ðŸ¤","":"ðŸ“…"},I={"Culto de avivamiento":["Oracion de apertura","Direccion","Devocional","Alabanzas","Mensaje","Oracion de cierre"],Celula:["Oracion de apertura","Direccion","Devocional","Alabanzas","Mensaje","Oracion de cierre"],"Estudio bÃ­blico":["Oracion de apertura","Encargado del estudio"],"Escuela de niÃ±os":["Encargado"],"Visita a enfermos":[],"Retiro congregacional":[],"Culto unido":[]},K=[{texto:"No dejando de congregarnos, como algunos tienen por costumbre, sino exhortÃ¡ndonos.",ref:"Hebreos 10:25"},{texto:"Porque donde estÃ¡n dos o tres congregados en mi nombre, alli estoy yo en medio de ellos.",ref:"Mateo 18:20"},{texto:"Yo me alegre con los que me decÃ­an: A la casa de Jehova iremos.",ref:"Salmos 122:1"},{texto:"Una cosa he demandado a Jehova; que este yo en la casa de Jehova todos los dias de mi vida.",ref:"Salmos 27:4"},{texto:"Y perseveraban en la doctrina de los apÃ³stoles, en la comuniÃ³n unos con otros, en el partimiento del pan y en las oraciones.",ref:"Hechos 2:42"},{texto:"Engrandezcan a JehovÃ¡ conmigo, y exaltemos su nombre a una.",ref:"Salmos 34:3"},{texto:"Cantad a JehovÃ¡ cÃ¡ntico nuevo; su alabanza sea en la congregaciÃ³n de los santos.",ref:"Salmos 149:1"}],xe=i=>{const u=new Date(i);u.setHours(0,0,0,0),u.setDate(u.getDate()+4-(u.getDay()||7));const x=new Date(u.getFullYear(),0,1);return`${u.getFullYear()}-W${Math.ceil(((u-x)/864e5+1)/7).toString().padStart(2,"0")}`},R=()=>xe(new Date),L=i=>({dia:i,tipo:"",hora:"",lugar:"",encargado:"",partes:{},pastor_visita:"",congregacion_visita:""}),fe=()=>({tipo_asignado:"miembro",miembro_id:"",pastor_externo:"",congregacion_externa:""}),Q=i=>{if(!window.speechSynthesis)return;window.speechSynthesis.cancel();const u=new SpeechSynthesisUtterance(i);u.lang="es-ES",u.rate=.9,window.speechSynthesis.speak(u)};function ve({label:i,parte:u,onChange:x,miembros:h}){const n=u||fe(),m=(r,f)=>x({...n,[r]:f});return e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:8,padding:"10px 14px",marginBottom:8},children:[e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"var(--gold)"},children:i}),e.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"flex-end"},children:[e.jsxs("div",{className:"form-group",style:{minWidth:180,flex:1},children:[e.jsx("label",{className:"form-label",children:"Asignado a"}),e.jsxs("select",{value:n.tipo_asignado,onChange:r=>m("tipo_asignado",r.target.value),className:"form-input",children:[e.jsx("option",{value:"miembro",children:"Miembro de la iglesia"}),e.jsx("option",{value:"externo",children:"Miembro de otra congregacion"})]})]}),n.tipo_asignado==="miembro"?e.jsxs("div",{className:"form-group",style:{minWidth:180,flex:2},children:[e.jsx("label",{className:"form-label",children:"Miembro"}),e.jsxs("select",{value:n.miembro_id,onChange:r=>m("miembro_id",r.target.value),className:"form-input",children:[e.jsx("option",{value:"",children:"-- Seleccionar --"}),h.map(r=>e.jsxs("option",{value:r.id,children:[r.nombres," ",r.apellidos]},r.id))]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",style:{minWidth:150,flex:1},children:[e.jsx("label",{className:"form-label",children:"Nombre del pastor"}),e.jsx("input",{value:n.pastor_externo,onChange:r=>m("pastor_externo",r.target.value),className:"form-input",placeholder:"Nombre"})]}),e.jsxs("div",{className:"form-group",style:{minWidth:150,flex:1},children:[e.jsx("label",{className:"form-label",children:"Congregacion"}),e.jsx("input",{value:n.congregacion_externa,onChange:r=>m("congregacion_externa",r.target.value),className:"form-input",placeholder:"Nombre congregacion"})]})]})]})]})}function je({diaData:i,miembros:u,onEscuchar:x}){const h=i,n=I[h.tipo]||[],m=ee[h.tipo]||"ðŸ“…",r=f=>{const v=h.partes[f];if(!v)return"Por asignar";if(v.tipo_asignado==="externo")return`${v.pastor_externo||"Pastor externo"} de ${v.congregacion_externa||"otra congregacion"}`;const b=u.find(s=>s.id===v.miembro_id);return b?`${b.nombres} ${b.apellidos}`:"Por asignar"};return h.tipo?e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:16,padding:20,marginBottom:12,border:"2px solid var(--gold)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:n.length>0?14:0},children:[e.jsx("span",{style:{fontSize:48},children:m}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:700,fontSize:22},children:h.dia}),e.jsx("div",{style:{color:"var(--gold)",fontWeight:600,fontSize:16},children:h.tipo}),h.hora&&e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:14},children:["Hora: ",h.hora]}),h.lugar&&e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:14},children:["Lugar: ",h.lugar]}),h.pastor_visita&&e.jsxs("div",{style:{color:"var(--text-muted)",fontSize:14},children:["Pastor: ",h.pastor_visita]})]}),e.jsx("button",{onClick:()=>x(h,r),style:{background:"var(--gold)",border:"none",borderRadius:50,width:56,height:56,fontSize:24,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:"ðŸ”Š"})]}),n.length>0&&e.jsx("div",{style:{borderTop:"1px solid var(--border)",paddingTop:12},children:n.map(f=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"6px 0",borderBottom:"1px solid var(--border)"},children:[e.jsx("span",{style:{color:"var(--text-muted)",fontSize:14},children:f}),e.jsx("span",{style:{fontWeight:600,fontSize:14},children:r(f)})]},f))})]}):e.jsxs("div",{style:{background:"var(--bg-card)",borderRadius:16,padding:20,marginBottom:12,display:"flex",alignItems:"center",gap:16,opacity:.5},children:[e.jsx("span",{style:{fontSize:40},children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:18},children:h.dia}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:14},children:"Sin actividad"})]})]})}function be({diaData:i,onChange:u,miembros:x}){const[h,n]=c.useState(!1),m=i,r=(s,N)=>u({...m,[s]:N}),f=I[m.tipo]||[],v=m.tipo==="Retiro congregacional"||m.tipo==="Culto unido",b=ee[m.tipo]||"ðŸ“…";return e.jsxs("div",{className:"card",style:{marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer"},onClick:()=>n(!h),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:28},children:b}),e.jsx("div",{style:{background:"var(--gold)",color:"#000",fontWeight:700,fontSize:13,borderRadius:6,padding:"4px 12px",minWidth:90,textAlign:"center"},children:m.dia}),m.tipo?e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:13},children:[m.tipo," ",m.hora?`- ${m.hora}`:""]}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:13},children:"Sin actividad"})]}),e.jsx("span",{style:{color:"var(--text-muted)"},children:h?"cerrar":"abrir"})]}),h&&e.jsxs("div",{style:{marginTop:16},children:[e.jsxs("div",{className:"grid-2",style:{gap:12,marginBottom:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tipo de actividad"}),e.jsxs("select",{value:m.tipo,onChange:s=>r("tipo",s.target.value),className:"form-input",children:[e.jsx("option",{value:"",children:"-- Sin actividad --"}),pe.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Hora"}),e.jsx("input",{type:"time",value:m.hora,onChange:s=>r("hora",s.target.value),className:"form-input"})]}),!v&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Lugar"}),e.jsx("input",{value:m.lugar,onChange:s=>r("lugar",s.target.value),className:"form-input",placeholder:"Ej: Templo principal"})]}),v&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Pastor"}),e.jsx("input",{value:m.pastor_visita,onChange:s=>r("pastor_visita",s.target.value),className:"form-input",placeholder:"Nombre del pastor"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Lugar"}),e.jsx("input",{value:m.lugar,onChange:s=>r("lugar",s.target.value),className:"form-input",placeholder:"Lugar del evento"})]})]})]}),f.length>0&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:10,color:"var(--text-muted)",textTransform:"uppercase",letterSpacing:1},children:"Partes del programa"}),f.map(s=>e.jsx(ve,{label:s,parte:m.partes[s],miembros:x,onChange:N=>r("partes",{...m.partes,[s]:N})},s))]}),m.tipo==="Visita a enfermos"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Encargado de la visita"}),e.jsxs("select",{value:m.encargado,onChange:s=>r("encargado",s.target.value),className:"form-input",children:[e.jsx("option",{value:"",children:"-- Seleccionar --"}),x.map(s=>e.jsxs("option",{value:s.id,children:[s.nombres," ",s.apellidos]},s.id))]})]})]})]})}function we(){const{puedeEditar:i}=H(),u=i("programa"),[x,h]=c.useState([]),[n,m]=c.useState(!1),[r,f]=c.useState(R()),[v,b]=c.useState({}),[s,N]=c.useState(!1),[p,j]=c.useState(!1),y=K[new Date().getDay()%K.length],w=r===R(),E=v[r]||O.map(L);c.useEffect(()=>{Z({limit:200}).then(t=>h(t.data)).catch(()=>{}),oe().then(t=>{const g=t.data||[];Promise.all(g.map(d=>le(d))).then(d=>{const a={};d.forEach(l=>{l.data&&(a[l.data.semana]=l.data.datos)}),b(a)})}).catch(()=>{})},[]);const k=(t,g)=>{const d=[...E];d[t]=g;const a={...v,[r]:d};b(a)},S=async()=>{try{await Y(r,E),N(!0),setTimeout(()=>N(!1),3e3)}catch{}},z=async()=>{if(!confirm("Deseas limpiar el programa de esta semana?"))return;const t={...v,[r]:O.map(L)};b(t);try{await Y(r,O.map(L))}catch{}},o=()=>{let t="Programa de la semana. ";E.forEach(g=>{if(!g.tipo){t+=`${g.dia}, sin actividad. `;return}t+=`${g.dia}, ${g.tipo}`,g.hora&&(t+=` a las ${g.hora}`),g.lugar&&(t+=`, en ${g.lugar}`),t+=". ",(I[g.tipo]||[]).forEach(a=>{const l=g.partes[a];if(l){const C=l.tipo_asignado==="externo"?`${l.pastor_externo} de ${l.congregacion_externa}`:x.find(_=>_.id===l.miembro_id)?`${x.find(_=>_.id===l.miembro_id).nombres} ${x.find(_=>_.id===l.miembro_id).apellidos}`:"por asignar";t+=`${a}: ${C}. `}})}),Q(t)},A=(t,g)=>{let d=`${t.dia}. ${t.tipo}`;t.hora&&(d+=` a las ${t.hora}`),t.lugar&&(d+=`, en ${t.lugar}`),t.pastor_visita&&(d+=`. Pastor ${t.pastor_visita}`),d+=". ",(I[t.tipo]||[]).forEach(l=>{d+=`${l}: ${g(l)}. `}),Q(d)},B=Object.keys(v).sort().reverse();return e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Programa Semanal"}),e.jsx("p",{className:"page-subtitle",children:"Ministerio San Juan 7:38 - Del Semillero 1/11"})]}),e.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>j(!p),children:p?"Ver actual":"Historial"}),u&&e.jsx("button",{className:"btn btn-ghost",onClick:()=>{var t;m(!n),(t=window.speechSynthesis)==null||t.cancel()},children:n?"Modo admin":"ðŸ”Š Modo facil"}),(n||!u)&&e.jsx("button",{onClick:o,style:{background:"var(--gold)",border:"none",borderRadius:8,padding:"8px 20px",fontWeight:700,fontSize:15,cursor:"pointer"},children:"ðŸ”Š Escuchar todo"}),u&&!n&&w&&e.jsx("button",{className:"btn btn-ghost",onClick:z,children:"Limpiar"}),u&&!n&&w&&e.jsx("button",{className:"btn btn-ghost",onClick:()=>window.print(),children:"Imprimir"}),u&&!n&&w&&e.jsx("button",{className:"btn btn-gold",onClick:S,children:"Guardar"})]})]}),s&&e.jsx("div",{className:"alert alert-success",style:{marginBottom:16},children:"Programa guardado correctamente"}),n&&e.jsxs("div",{style:{background:"var(--gold)",borderRadius:12,padding:"16px 20px",marginBottom:20,display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:32},children:"ðŸ”Š"}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,fontSize:16,color:"#000"},children:"Modo facil activado"}),e.jsx("div",{style:{fontSize:13,color:"#333"},children:"Presiona el boton ðŸ”Š en cada dia para escuchar el programa, o presiona Escuchar todo para oir toda la semana."})]})]}),p?e.jsxs("div",{className:"card",children:[e.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontSize:16,fontWeight:600,marginBottom:16},children:"Historial de programas"}),B.length===0?e.jsx("p",{style:{color:"var(--text-muted)"},children:"No hay programas guardados aun."}):B.map(t=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 0",borderBottom:"1px solid var(--border)"},children:[e.jsxs("span",{style:{fontWeight:500},children:["Semana: ",t]}),e.jsx("button",{className:"btn btn-ghost",style:{fontSize:13},onClick:()=>{f(t),j(!1)},children:"Ver programa"})]},t))]}):e.jsxs(e.Fragment,{children:[!w&&e.jsxs("div",{style:{background:"var(--bg-card)",border:"1px solid var(--gold)",borderRadius:8,padding:"10px 16px",marginBottom:16,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{color:"var(--gold)",fontWeight:600},children:["Viendo semana anterior: ",r]}),e.jsx("button",{className:"btn btn-ghost",style:{fontSize:13},onClick:()=>f(R()),children:"Volver a semana actual"})]}),e.jsxs("div",{className:"card",style:{marginBottom:20,borderLeft:"3px solid var(--gold)"},children:[e.jsxs("p",{style:{fontStyle:"italic",fontSize:14,marginBottom:4},children:['"',y.texto,'"']}),e.jsxs("span",{style:{color:"var(--gold)",fontSize:12,fontWeight:600},children:["-- ",y.ref]})]}),n||!u?E.map((t,g)=>e.jsx(je,{diaData:t,miembros:x,onEscuchar:A},t.dia)):E.map((t,g)=>e.jsx(be,{diaData:t,index:g,onChange:d=>k(g,d),miembros:x},t.dia))]}),e.jsx("style",{children:`
        @media print {
          .sidebar, .page-header button, .btn { display: none !important; }
          .card { box-shadow: none !important; border: 1px solid #ccc !important; }
          body { background: white !important; color: black !important; }
        }
      `})]})}const $={alta:{label:"Urgente",color:"var(--red)"},media:{label:"Normal",color:"var(--gold)"},baja:{label:"Informativo",color:"var(--green)"}},F=()=>({titulo:"",contenido:"",prioridad:"media",fecha_expira:""});function De(){const{puedeEditar:i}=H(),u=i("anuncios"),[x,h]=c.useState([]),[n,m]=c.useState(F()),[r,f]=c.useState(null),[v,b]=c.useState(!1),[s,N]=c.useState(!0),p=o=>m({...n,[o.target.name]:o.target.value}),j=async()=>{try{const{data:o}=await ce();h(o)}catch{}N(!1)};c.useEffect(()=>{j()},[]);const y=async()=>{if(!(!n.titulo||!n.contenido))try{const o={...n,fecha_expira:n.fecha_expira||null};r!==null?await de(r,o):await me(o),f(null),m(F()),b(!1),j()}catch{}},w=async o=>{if(confirm("Â¿Eliminar este anuncio?"))try{await ge(o),j()}catch{}},E=o=>{m({titulo:o.titulo,contenido:o.contenido,prioridad:o.prioridad,fecha_expira:o.fecha_expira||""}),f(o.id),b(!0)},k=new Date().toISOString().split("T")[0],S=x.filter(o=>!o.fecha_expira||o.fecha_expira>=k),z=x.filter(o=>o.fecha_expira&&o.fecha_expira<k);return e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Anuncios"}),e.jsxs("p",{className:"page-subtitle",children:[S.length," anuncio",S.length!==1?"s":""," activo",S.length!==1?"s":""]})]}),u&&e.jsx("button",{className:"btn btn-gold",onClick:()=>{m(F()),f(null),b(!0)},children:"+ Nuevo anuncio"})]}),s&&e.jsx("div",{style:{textAlign:"center",padding:40},children:e.jsx("span",{className:"spinner"})}),!s&&S.length===0&&e.jsxs("div",{className:"card",style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:40,marginBottom:12},children:"ðŸ“¢"}),e.jsx("p",{children:"No hay anuncios activos. Crea uno nuevo."})]}),S.map(o=>{var A,B,t;return e.jsx("div",{className:"card",style:{marginBottom:14,borderLeft:`3px solid ${((A=$[o.prioridad])==null?void 0:A.color)||"var(--gold)"}`},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:12},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[e.jsx("span",{style:{background:(B=$[o.prioridad])==null?void 0:B.color,color:"#fff",fontSize:11,fontWeight:700,borderRadius:4,padding:"2px 8px"},children:(t=$[o.prioridad])==null?void 0:t.label}),e.jsx("span",{style:{color:"var(--text-muted)",fontSize:12},children:new Date(o.fecha).toLocaleDateString("es-DO")}),o.fecha_expira&&e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:["Â· Expira: ",new Date(o.fecha_expira).toLocaleDateString("es-DO")]})]}),e.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontSize:16,fontWeight:700,marginBottom:6},children:o.titulo}),e.jsx("p",{style:{color:"var(--text-muted)",fontSize:14,lineHeight:1.6,whiteSpace:"pre-wrap"},children:o.contenido})]}),e.jsxs("div",{style:{display:"flex",gap:6,flexShrink:0},children:[e.jsx("button",{className:"btn btn-ghost",style:{padding:"5px 10px",fontSize:12},onClick:()=>E(o),children:"Editar"}),e.jsx("button",{className:"btn btn-danger",style:{padding:"5px 10px",fontSize:12},onClick:()=>w(o.id),children:"âœ•"})]})]})},o.id)}),z.length>0&&e.jsxs("div",{style:{marginTop:24},children:[e.jsx("h3",{style:{color:"var(--text-muted)",fontSize:13,textTransform:"uppercase",letterSpacing:1,marginBottom:12},children:"Anuncios expirados"}),z.map(o=>e.jsx("div",{className:"card",style:{marginBottom:10,opacity:.5},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600,fontSize:14},children:o.titulo}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12,marginLeft:10},children:["ExpirÃ³: ",new Date(o.fecha_expira).toLocaleDateString("es-DO")]})]}),e.jsx("button",{className:"btn btn-danger",style:{padding:"4px 10px",fontSize:12},onClick:()=>w(o.id),children:"âœ•"})]})},o.id))]}),v&&e.jsx("div",{className:"modal-overlay",onClick:o=>o.target===o.currentTarget&&b(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:520},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"modal-title",children:r!==null?"Editar anuncio":"Nuevo anuncio"}),e.jsx("button",{className:"modal-close",onClick:()=>b(!1),children:"Ã—"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Titulo *"}),e.jsx("input",{name:"titulo",value:n.titulo,onChange:p,className:"form-input",placeholder:"Ej: Retiro congregacional este sabado",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Contenido *"}),e.jsx("textarea",{name:"contenido",value:n.contenido,onChange:p,className:"form-input",rows:4,style:{resize:"vertical"},placeholder:"Escribe aquÃ­ el detalle del anuncio..."})]}),e.jsxs("div",{className:"grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Prioridad"}),e.jsxs("select",{name:"prioridad",value:n.prioridad,onChange:p,className:"form-input",children:[e.jsx("option",{value:"alta",children:"Urgente"}),e.jsx("option",{value:"media",children:"Normal"}),e.jsx("option",{value:"baja",children:"Informativo"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Fecha de expiracion"}),e.jsx("input",{name:"fecha_expira",type:"date",value:n.fecha_expira,onChange:p,className:"form-input"})]})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end",marginTop:4},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>b(!1),children:"Cancelar"}),e.jsx("button",{className:"btn btn-gold",onClick:y,children:r!==null?"Actualizar":"Publicar anuncio"})]})]})]})})]})}const M="asistencia_iglesia",ye=["Culto de avivamiento","Estudio bÃ­blico","Escuela de niÃ±os","Celula","Retiro congregacional","Culto unido","Otro"],Ne=()=>new Date().toISOString().split("T")[0];function Ee(){const[i,u]=c.useState([]),[x,h]=c.useState(()=>{try{return JSON.parse(localStorage.getItem(M))||[]}catch{return[]}}),[n,m]=c.useState("registrar"),[r,f]=c.useState(Ne()),[v,b]=c.useState("Culto de avivamiento"),[s,N]=c.useState({}),[p,j]=c.useState(""),[y,w]=c.useState(!1),[E,k]=c.useState(!0),[S,z]=c.useState(null);c.useEffect(()=>{Z({limit:500}).then(a=>{const l=a.data.filter(_=>_.estado==="activo");u(l);const C={};l.forEach(_=>C[_.id]=!1),N(C)}).catch(()=>{}).finally(()=>k(!1))},[]);const o=a=>{const l={};i.forEach(C=>l[C.id]=a),N(l)},A=()=>{const a=i.filter(D=>s[D.id]).map(D=>({id:D.id,nombre:`${D.nombres} ${D.apellidos}`})),C=[{id:Date.now(),fecha:r,tipo:v,total_miembros:i.length,total_presentes:a.length,presentes:a},...x];h(C),localStorage.setItem(M,JSON.stringify(C)),w(!0),setTimeout(()=>w(!1),3e3);const _={};i.forEach(D=>_[D.id]=!1),N(_)},B=a=>{if(!confirm("Â¿Eliminar este registro?"))return;const l=x.filter(C=>C.id!==a);h(l),localStorage.setItem(M,JSON.stringify(l)),z(null)},t=i.filter(a=>`${a.nombres} ${a.apellidos}`.toLowerCase().includes(p.toLowerCase())),g=i.filter(a=>s[a.id]).length,d=i.map(a=>{const l=x.length,C=x.filter(D=>D.presentes.some(W=>W.id===a.id)).length,_=l>0?Math.round(C/l*100):0;return{...a,asistio:C,total:l,porcentaje:_}}).sort((a,l)=>a.porcentaje-l.porcentaje);return e.jsxs("div",{className:"page",children:[e.jsx("div",{className:"page-header",children:e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Asistencia"}),e.jsxs("p",{className:"page-subtitle",children:[x.length," registros guardados"]})]})}),e.jsx("div",{style:{display:"flex",gap:4,marginBottom:20,borderBottom:"1px solid var(--border)"},children:[["registrar","Registrar asistencia"],["historial","Historial"],["resumen","Resumen por miembro"]].map(([a,l])=>e.jsx("button",{onClick:()=>m(a),style:{background:"none",border:"none",cursor:"pointer",padding:"8px 18px",color:n===a?"var(--gold)":"var(--text-muted)",borderBottom:n===a?"2px solid var(--gold)":"2px solid transparent",fontSize:14,fontWeight:500,fontFamily:"var(--font-body)"},children:l},a))}),n==="registrar"&&e.jsxs("div",{children:[y&&e.jsx("div",{className:"alert alert-success",style:{marginBottom:16},children:"Asistencia guardada correctamente"}),e.jsx("div",{className:"card",style:{marginBottom:16},children:e.jsxs("div",{className:"grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Fecha"}),e.jsx(X,{name:"fecha",value:r,onChange:a=>f(a.target.value)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tipo de actividad"}),e.jsx("select",{value:v,onChange:a=>b(a.target.value),className:"form-input",children:ye.map(a=>e.jsx("option",{value:a,children:a},a))})]})]})}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:14,flexWrap:"wrap",gap:10},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600},children:"Presentes: "}),e.jsx("span",{style:{color:"var(--gold)",fontWeight:700,fontSize:18},children:g}),e.jsxs("span",{style:{color:"var(--text-muted)"},children:[" / ",i.length]})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-ghost",style:{fontSize:13},onClick:()=>o(!0),children:"Marcar todos"}),e.jsx("button",{className:"btn btn-ghost",style:{fontSize:13},onClick:()=>o(!1),children:"Desmarcar todos"})]})]}),e.jsxs("div",{className:"search-bar",style:{marginBottom:14},children:[e.jsx("span",{className:"search-icon",children:"âŒ•"}),e.jsx("input",{placeholder:"Buscar miembro...",value:p,onChange:a=>j(a.target.value)})]}),E?e.jsx("div",{style:{textAlign:"center",padding:30},children:e.jsx("span",{className:"spinner"})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,maxHeight:400,overflowY:"auto"},children:t.map(a=>e.jsxs("div",{onClick:()=>N({...s,[a.id]:!s[a.id]}),style:{display:"flex",alignItems:"center",gap:12,padding:"10px 14px",borderRadius:8,cursor:"pointer",background:s[a.id]?"rgba(var(--gold-rgb),0.1)":"var(--bg-card)",border:s[a.id]?"1px solid var(--gold)":"1px solid var(--border)",transition:"all 0.15s"},children:[e.jsx("div",{style:{width:22,height:22,borderRadius:4,border:`2px solid ${s[a.id]?"var(--gold)":"var(--border)"}`,background:s[a.id]?"var(--gold)":"transparent",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:s[a.id]&&e.jsx("span",{style:{color:"#000",fontSize:14,fontWeight:700},children:"âœ“"})}),e.jsxs("span",{style:{fontWeight:s[a.id]?600:400},children:[a.nombres," ",a.apellidos]}),e.jsx("span",{className:`badge ${s[a.id]?"badge-green":""}`,style:{marginLeft:"auto",fontSize:11},children:s[a.id]?"Presente":"Ausente"})]},a.id))}),e.jsx("button",{className:"btn btn-gold",onClick:A,style:{width:"100%",marginTop:16,justifyContent:"center"},children:"Guardar asistencia"})]})]}),n==="historial"&&e.jsx("div",{className:"card",children:x.length===0?e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center",padding:30},children:"No hay registros de asistencia aun."}):x.map(a=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"14px 0",borderBottom:"1px solid var(--border)",flexWrap:"wrap",gap:8},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:a.tipo}),e.jsx("div",{style:{color:"var(--text-muted)",fontSize:13},children:new Date(a.fecha).toLocaleDateString("es-DO",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:700,fontSize:20,color:"var(--gold)"},children:a.total_presentes}),e.jsxs("div",{style:{fontSize:11,color:"var(--text-muted)"},children:["de ",a.total_miembros]})]}),e.jsxs("div",{style:{width:50,height:50,borderRadius:"50%",background:"var(--bg-card)",border:`3px solid ${a.total_presentes/a.total_miembros>.7?"var(--green)":a.total_presentes/a.total_miembros>.4?"var(--gold)":"var(--red)"}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,fontSize:13},children:[Math.round(a.total_presentes/a.total_miembros*100),"%"]}),e.jsxs("div",{style:{display:"flex",gap:6},children:[e.jsx("button",{className:"btn btn-ghost",style:{fontSize:12,padding:"4px 10px"},onClick:()=>z(a),children:"Ver"}),e.jsx("button",{className:"btn btn-danger",style:{fontSize:12,padding:"4px 10px"},onClick:()=>B(a.id),children:"âœ•"})]})]})]},a.id))}),n==="resumen"&&e.jsxs("div",{className:"card",children:[e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:13,marginBottom:16},children:["Basado en ",x.length," registros. Los miembros con menor asistencia aparecen primero."]}),d.length===0?e.jsx("p",{style:{color:"var(--text-muted)",textAlign:"center",padding:30},children:"No hay datos aun."}):e.jsx("div",{className:"table-wrap",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Miembro"}),e.jsx("th",{children:"Asistencias"}),e.jsx("th",{children:"Total cultos"}),e.jsx("th",{children:"Porcentaje"}),e.jsx("th",{children:"Estado"})]})}),e.jsx("tbody",{children:d.map(a=>e.jsxs("tr",{children:[e.jsxs("td",{style:{fontWeight:500},children:[a.nombres," ",a.apellidos]}),e.jsx("td",{style:{color:"var(--gold)",fontWeight:600},children:a.asistio}),e.jsx("td",{style:{color:"var(--text-muted)"},children:a.total}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{flex:1,height:6,background:"var(--border)",borderRadius:3},children:e.jsx("div",{style:{width:`${a.porcentaje}%`,height:"100%",borderRadius:3,background:a.porcentaje>70?"var(--green)":a.porcentaje>40?"var(--gold)":"var(--red)"}})}),e.jsxs("span",{style:{fontSize:13,fontWeight:600,minWidth:35},children:[a.porcentaje,"%"]})]})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${a.porcentaje>70?"badge-green":a.porcentaje>40?"badge-amber":"badge-red"}`,children:a.porcentaje>70?"Regular":a.porcentaje>40?"Irregular":"Ausente frecuente"})})]},a.id))})]})})]}),S&&e.jsx("div",{className:"modal-overlay",onClick:a=>a.target===a.currentTarget&&z(null),children:e.jsxs("div",{className:"modal",style:{maxWidth:500},children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h3",{className:"modal-title",children:[S.tipo," â€” ",new Date(S.fecha).toLocaleDateString("es-DO")]}),e.jsx("button",{className:"modal-close",onClick:()=>z(null),children:"Ã—"})]}),e.jsxs("p",{style:{color:"var(--text-muted)",fontSize:13,marginBottom:14},children:[S.total_presentes," de ",S.total_miembros," miembros presentes"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6,maxHeight:300,overflowY:"auto"},children:S.presentes.map(a=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"8px 12px",background:"var(--bg-card)",borderRadius:8},children:[e.jsx("span",{style:{color:"var(--green)",fontWeight:700},children:"âœ“"}),e.jsx("span",{children:a.nombre})]},a.id))})]})})]})}const V="documentos_iglesia",J=["Actas","Permisos y licencias","Estatutos","Contratos","Certificados","Financiero","Otro"],G=()=>({nombre:"",categoria:"Actas",fecha:"",descripcion:"",url:"",archivo_nombre:""});function ke(){const[i,u]=c.useState(()=>{try{return JSON.parse(localStorage.getItem(V))||[]}catch{return[]}}),[x,h]=c.useState(!1),[n,m]=c.useState(null),[r,f]=c.useState(G()),[v,b]=c.useState(""),[s,N]=c.useState(""),[p,j]=c.useState(!1),y=t=>f({...r,[t.target.name]:t.target.value}),w=t=>{const g=t.target.files[0];if(!g)return;const d=new FileReader;d.onload=a=>{f(l=>({...l,archivo_nombre:g.name,url:a.target.result}))},d.readAsDataURL(g)},E=()=>{if(!r.nombre)return;let t;n!==null?(t=i.map((g,d)=>d===n?{...r,id:g.id}:g),m(null)):t=[{...r,id:Date.now(),fecha_subida:new Date().toISOString()},...i],u(t),localStorage.setItem(V,JSON.stringify(t)),f(G()),h(!1),j(!0),setTimeout(()=>j(!1),3e3)},k=t=>{if(!confirm("Â¿Eliminar este documento?"))return;const g=i.filter(d=>d.id!==t);u(g),localStorage.setItem(V,JSON.stringify(g))},S=t=>{f(i[t]),m(t),h(!0)},z=t=>{if(!t.url)return;const g=document.createElement("a");g.href=t.url,g.download=t.archivo_nombre||t.nombre,g.click()},o={Actas:"ðŸ“‹","Permisos y licencias":"ðŸ“œ",Estatutos:"ðŸ“–",Contratos:"ðŸ¤",Certificados:"ðŸ†",Financiero:"ðŸ’°",Otro:"ðŸ“„"},A=i.filter(t=>{var a;const g=t.nombre.toLowerCase().includes(v.toLowerCase())||((a=t.descripcion)==null?void 0:a.toLowerCase().includes(v.toLowerCase())),d=!s||t.categoria===s;return g&&d}),B=J.map(t=>({cat:t,docs:A.filter(g=>g.categoria===t)})).filter(t=>t.docs.length>0);return e.jsxs("div",{className:"page",children:[e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"page-title",children:"Documentos"}),e.jsxs("p",{className:"page-subtitle",children:[i.length," documento",i.length!==1?"s":""," guardado",i.length!==1?"s":""]})]}),e.jsx("button",{className:"btn btn-gold",onClick:()=>{f(G()),m(null),h(!0)},children:"+ Subir documento"})]}),p&&e.jsx("div",{className:"alert alert-success",style:{marginBottom:16},children:"Documento guardado correctamente"}),e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:20,flexWrap:"wrap"},children:[e.jsxs("div",{className:"search-bar",children:[e.jsx("span",{className:"search-icon",children:"âŒ•"}),e.jsx("input",{placeholder:"Buscar documento...",value:v,onChange:t=>b(t.target.value)})]}),e.jsxs("select",{value:s,onChange:t=>N(t.target.value),className:"form-input",style:{width:"auto"},children:[e.jsx("option",{value:"",children:"Todas las categorias"}),J.map(t=>e.jsx("option",{value:t,children:t},t))]})]}),A.length===0?e.jsxs("div",{className:"card",style:{textAlign:"center",padding:40,color:"var(--text-muted)"},children:[e.jsx("div",{style:{fontSize:40,marginBottom:12},children:"ðŸ“‚"}),e.jsx("p",{children:"No hay documentos guardados. Sube el primero."})]}):B.map(({cat:t,docs:g})=>e.jsxs("div",{style:{marginBottom:24},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[e.jsx("span",{style:{fontSize:20},children:o[t]}),e.jsx("h3",{style:{fontFamily:"var(--font-heading)",fontSize:15,fontWeight:700,color:"var(--gold)"},children:t}),e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:["(",g.length,")"]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:g.map((d,a)=>e.jsxs("div",{className:"card",style:{display:"flex",alignItems:"center",gap:16,padding:"14px 18px"},children:[e.jsx("span",{style:{fontSize:32,flexShrink:0},children:o[d.categoria]||"ðŸ“„"}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{style:{fontWeight:600,fontSize:15,marginBottom:4},children:d.nombre}),e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[d.fecha&&e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:["Fecha: ",new Date(d.fecha).toLocaleDateString("es-DO")]}),d.archivo_nombre&&e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:["Archivo: ",d.archivo_nombre]}),d.fecha_subida&&e.jsxs("span",{style:{color:"var(--text-muted)",fontSize:12},children:["Subido: ",new Date(d.fecha_subida).toLocaleDateString("es-DO")]})]}),d.descripcion&&e.jsx("p",{style:{color:"var(--text-muted)",fontSize:13,marginTop:4},children:d.descripcion})]}),e.jsxs("div",{style:{display:"flex",gap:6,flexShrink:0},children:[d.url&&e.jsx("button",{className:"btn btn-gold",style:{padding:"5px 12px",fontSize:12},onClick:()=>z(d),children:"Descargar"}),e.jsx("button",{className:"btn btn-ghost",style:{padding:"5px 10px",fontSize:12},onClick:()=>S(i.indexOf(d)),children:"Editar"}),e.jsx("button",{className:"btn btn-danger",style:{padding:"5px 10px",fontSize:12},onClick:()=>k(d.id),children:"âœ•"})]})]},d.id))})]},t)),x&&e.jsx("div",{className:"modal-overlay",onClick:t=>t.target===t.currentTarget&&h(!1),children:e.jsxs("div",{className:"modal",style:{maxWidth:520},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"modal-title",children:n!==null?"Editar documento":"Subir documento"}),e.jsx("button",{className:"modal-close",onClick:()=>h(!1),children:"Ã—"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:14},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Nombre del documento *"}),e.jsx("input",{name:"nombre",value:r.nombre,onChange:y,className:"form-input",placeholder:"Ej: Acta de fundacion",required:!0})]}),e.jsxs("div",{className:"grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Categoria"}),e.jsx("select",{name:"categoria",value:r.categoria,onChange:y,className:"form-input",children:J.map(t=>e.jsx("option",{value:t,children:t},t))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Fecha del documento"}),e.jsx(DatePicker,{name:"fecha",value:r.fecha,onChange:y})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Descripcion"}),e.jsx("textarea",{name:"descripcion",value:r.descripcion,onChange:y,className:"form-input",rows:3,style:{resize:"vertical"},placeholder:"Descripcion breve del documento..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Subir archivo (PDF, imagen, Word)"}),e.jsx("input",{type:"file",onChange:w,className:"form-input",accept:".pdf,.doc,.docx,.jpg,.jpeg,.png"}),r.archivo_nombre&&e.jsxs("div",{style:{color:"var(--green)",fontSize:12,marginTop:4},children:["Archivo: ",r.archivo_nombre]})]}),e.jsxs("div",{style:{display:"flex",gap:10,justifyContent:"flex-end"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>h(!1),children:"Cancelar"}),e.jsx("button",{className:"btn btn-gold",onClick:E,children:n!==null?"Actualizar":"Guardar documento"})]})]})]})})]})}export{De as A,ke as D,_e as E,we as P,ze as a,Ee as b};
